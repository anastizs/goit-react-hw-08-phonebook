"use strict";(self.webpackChunkgoit_react_hw_08_phonebook=self.webpackChunkgoit_react_hw_08_phonebook||[]).push([[974],{974:function(e,n,r){r.r(n),r.d(n,{default:function(){return V}});var t=r(5048),a=r(1614),i=r(9658),o=r(7317),c=r(890),s=r(9953),l=r(9877),d=r(2419),u=r(5193),h=r(1413),m=r(9439),x=r(2791),Z=r(4554),f=r(3044),v=r(3239),j=r(7665),p=r(4518),b=r(8535),g=r(1286),w=r(4802),y=r(6727),C=r(6546),k=r(6351),L=r(7748),_=r(184);function A(){var e=(0,t.v9)(k.tU),n=(0,t.v9)(k.rn),r=(0,x.useState)({name:!0,number:!0}),i=(0,m.Z)(r,2),o=i[0],c=i[1],s=(0,L.Jx)().data,l=(0,L.Tn)(),d=(0,m.Z)(l,2),u=d[0],A=d[1].isLoading,S=(0,L.i)(),P=(0,m.Z)(S,2),z=P[0],I=P[1].isLoading,D=A||I,N=(0,t.I0)(),W=e==="new",E=e==="edit",F=function(e){return s.find((function(n){return n.id===e}))},J=(0,x.useRef)(E?F(n):null),T=(0,x.useState)(n?F(n).name:""),$=(0,m.Z)(T,2),q=$[0],M=$[1],R=(0,x.useState)(n?F(n).number:""),Y=(0,m.Z)(R,2),B=Y[0],G=Y[1],K=(0,y.Z_)().matches(/^[a-zA-Z\u0430-\u044f\u0456\u0457\u0454\u0491\u0410-\u042f\u0406\u0407\u0404\u0490]+([' -][a-zA-Z\u0430-\u044f\u0456\u0457\u0454\u0491\u0410-\u042f\u0406\u0407\u0404\u0490]*)*$/).max(35),U=(0,y.Z_)().matches(/\+?\d{1,4}?[-.\s]?\(?\d{1,3}?\)?[-.\s]?\d{1,4}[-.\s]?\d{1,4}[-.\s]?\d{1,9}/).max(20),V=function(e){var n=e.currentTarget,r=n.name,t=n.value;switch(r){case"name":K.validate(t).then((function(){return c((function(e){return(0,h.Z)((0,h.Z)({},e),{},{name:!0})}))})).catch((function(){return c((function(e){return(0,h.Z)((0,h.Z)({},e),{},{name:!1})}))})),M(t);break;case"number":U.validate(t).then((function(){return c((function(e){return(0,h.Z)((0,h.Z)({},e),{},{number:!0})}))})).catch((function(){return c((function(e){return(0,h.Z)((0,h.Z)({},e),{},{number:!1})}))})),G(t);break;default:throw new Error("unsupported input name")}};return(0,_.jsx)(a.Z,{maxWidth:"xs",sx:{my:4},children:(0,_.jsxs)(Z.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,_.jsx)(f.Z,{sx:{m:1,bgcolor:"secondary.main"},children:D?(0,_.jsx)(v.Z,{size:24,color:"inherit"}):E?(0,_.jsx)(g.Z,{}):(0,_.jsx)(b.Z,{})}),(0,_.jsxs)(Z.Z,{sx:{textAlign:"center"},component:"form",onSubmit:function(e){var r,t;e.preventDefault();var a=e.currentTarget.elements,i=a.name.value,c=a.number.value;if(o.name)if(o.number){var l=s.some((function(e){return e.name.toLowerCase()===i.toLowerCase()})),d=(null===J||void 0===J||null===(r=J.current)||void 0===r||null===(t=r.name)||void 0===t?void 0:t.toLowerCase())===i.toLowerCase();!l||d?(W&&u({name:i,number:c}).then((function(e){var n=e.data;N((0,C.dL)()),(0,w.yv)("Contact ".concat(n.name," added"),{variant:"success"})})).catch((function(){return(0,w.yv)("Something went wrong",{variant:"error"})})),E&&z([n,{name:i,number:c}]).then((function(e){var n=e.data;N((0,C.dL)()),(0,w.yv)("Contact ".concat(n.name," edited"),{variant:"success"})})).catch((function(){return(0,w.yv)("Something went wrong",{variant:"error"})}))):(0,w.yv)("".concat(i," is already in contacts"),{variant:"warning"})}else(0,w.yv)("Please enter the correct number",{variant:"error"});else(0,w.yv)("Please enter the correct name",{variant:"error"})},children:[(0,_.jsx)(j.Z,{fullWidth:!0,margin:"normal",label:"Name",type:"text",name:"name",value:q,error:!o.name,title:"Name may contain only letters, apostrophe, dash and spaces. For example Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan",required:!0,autoFocus:!0,onChange:V}),(0,_.jsx)(j.Z,{fullWidth:!0,margin:"normal",label:"Number",type:"tel",name:"number",value:B,error:!o.number,title:"Phone number must be digits and can contain spaces, dashes, parentheses and can start with +",required:!0,onChange:V}),(0,_.jsx)(p.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:D,children:W?"Add new contact":"Save contact"})]})," ",(0,_.jsx)(p.Z,{type:"button",fullWidth:!0,variant:"outlined",sx:{mb:2},onClick:function(){return N((0,C.dL)())},children:"Cancel"})]})})}var S=r(493),P=r(5021),z=r(3768),I=r(3400),D=r(6278),N=r(653),W=r(9900),E=r(8619),F=r(7247);function J(e){var n=e.name,r=e.number,a=e.id,i=(0,L.Nt)(),o=(0,m.Z)(i,2),c=o[0],s=o[1].isLoading,l=(0,t.I0)();return(0,_.jsx)(P.ZP,{sx:{pr:"96px",pl:0},secondaryAction:(0,_.jsxs)(Z.Z,{sx:{display:"flex",gap:"10px"},children:[(0,_.jsx)(z.Z,{title:"Edit",children:(0,_.jsx)(I.Z,{"aria-label":"edit",onClick:function(){return l((0,C.$8)(a))},children:(0,_.jsx)(g.Z,{})})}),(0,_.jsx)(z.Z,{title:"Delete",children:(0,_.jsx)(I.Z,{edge:"end","aria-label":"delete",disabled:s,onClick:function(){return c(a).then((function(e){var n=e.data;(0,w.yv)("Contact ".concat(n.name," deleted"),{variant:"info"})})).catch((function(){return(0,w.yv)("Something went wrong",{variant:"error"})}))},children:s?(0,_.jsx)(v.Z,{size:24}):(0,_.jsx)(F.Z,{})})})]}),children:(0,_.jsxs)(D.Z,{href:"tel:".concat(r),sx:{p:0},children:[(0,_.jsx)(N.Z,{children:(0,_.jsx)(f.Z,{children:(0,_.jsx)(E.Z,{})})}),(0,_.jsx)(W.Z,{primary:"".concat(n),secondary:"".concat(r)})]})})}function T(){var e=(0,L.Jx)().data,n=void 0===e?[]:e,r=(0,t.v9)(k.AD),a=n.filter((function(e){return e.name.toLowerCase().includes(r)}));return(0,_.jsx)(S.Z,{children:a.map((function(e){return(0,_.jsx)(J,(0,h.Z)({},e),e.id)}))})}var $=r(2739);function q(){return(0,_.jsx)($.Z,{open:!0,sx:{color:"#fff",zIndex:function(e){return e.zIndex.drawer+1}},children:(0,_.jsx)(v.Z,{color:"inherit"})})}var M=r(4321),R=r(5289),Y=r(7123),B=r(9157),G=r(1691),K=r(5661);function U(){var e=(0,t.v9)(k.R_),n=(0,t.I0)();return(0,_.jsxs)(R.Z,{open:e,onClose:function(){return n((0,C.gk)())},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,_.jsx)(K.Z,{id:"alert-dialog-title",children:"Are you sure?"}),(0,_.jsx)(B.Z,{children:(0,_.jsx)(G.Z,{id:"alert-dialog-description",children:"\u0421losing the window will delete unsaved data"})}),(0,_.jsxs)(Y.Z,{children:[(0,_.jsx)(p.Z,{onClick:function(){return n((0,C.gk)())},children:"No"}),(0,_.jsx)(p.Z,{onClick:function(){n((0,C.gk)()),n((0,C.dL)())},autoFocus:!0,children:"Yes"})]})]})}function V(){var e=(0,t.v9)(k.Vc),n=(0,t.I0)(),r=(0,L.Jx)(),h=r.data,m=void 0===h?[]:h,x=r.isError,Z=r.isLoading,f=(0,u.Z)("(max-width:786px)");return(0,_.jsxs)(a.Z,{component:"main",children:[Z&&(0,_.jsx)(M.Z,{}),x&&(0,_.jsxs)(i.Z,{severity:"error",children:[(0,_.jsx)(o.Z,{children:"Error"}),"Something went wrong. Please reload the page"]}),Z||x||0!==m.length?!Z&&!x&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(c.Z,{align:"center",component:"h1",variant:"h4",children:"Contacts"}),(0,_.jsx)(q,{}),(0,_.jsx)(T,{})]}):(0,_.jsx)(c.Z,{sx:{mt:4},align:"center",variant:"h5",paragraph:!0,children:"Your phone book is empty. Please click the button in the lower right corner and add new contacts."}),(0,_.jsx)(s.ZP,{anchor:f?"top":"bottom",open:e,ModalProps:{onClose:function(e,r){n("escapeKeyDown"!==r&&"backdropClick"!==r?(0,C.dL)():(0,C.G3)())}},children:(0,_.jsx)(A,{})}),(0,_.jsx)(l.Z,{sx:{position:"fixed",bottom:16,right:16},color:"primary","aria-label":"add",onClick:function(){return n((0,C.$A)())},children:(0,_.jsx)(d.Z,{})}),(0,_.jsx)(U,{})]})}}}]);
//# sourceMappingURL=974.161e6fc6.chunk.js.map